<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ContribMSBuildTypeLibrarySourcePath>$(TargetPath)</ContribMSBuildTypeLibrarySourcePath>
    <ContribMSBuildTypeLibraryTypeLibraryTargetPath>$(TargetDir)$(TargetName).tlb</ContribMSBuildTypeLibraryTypeLibraryTargetPath>
    <ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath>$(TargetDir)$(TargetName).reg</ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath>
    <ContribMSBuildTypeLibraryBuildTypeLibraryBeforeTargets></ContribMSBuildTypeLibraryBuildTypeLibraryBeforeTargets>
    <ContribMSBuildTypeLibraryBuildTypeLibraryAfterTargets>Build</ContribMSBuildTypeLibraryBuildTypeLibraryAfterTargets>
    <ContribMSBuildTypeLibraryBuildAssemblyRegistrationBeforeTargets></ContribMSBuildTypeLibraryBuildAssemblyRegistrationBeforeTargets>
    <ContribMSBuildTypeLibraryBuildAssemblyRegistrationAfterTargets>Build</ContribMSBuildTypeLibraryBuildAssemblyRegistrationAfterTargets>
  </PropertyGroup>
  <Import Project="$(ProjectDir)Contrib.MSBuild.TypeLibrary.props" />
  <PropertyGroup Condition="$(ContribMSBuildTypeLibraryTlbExpPath) == ''">
    <ContribMSBuildTypeLibraryTlbExpPath>$(TargetFrameworkSDKToolsDirectory)tlbexp.exe</ContribMSBuildTypeLibraryTlbExpPath>
  </PropertyGroup>
  <PropertyGroup Condition="$(ContribMSBuildTypeLibraryRegAsmPath) == ''">
    <ContribMSBuildTypeLibraryRegAsmPath>$(FrameworkDir)\RegAsm.exe</ContribMSBuildTypeLibraryRegAsmPath>
  </PropertyGroup>
  <ItemGroup>
    <FileWrites Include="$(ContribMSBuildTypeLibraryTypeLibraryTargetPath);$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)" />
  </ItemGroup>
  <Target Name="ContribMSBuildTypeLibraryBuildTypeLibrary" BeforeTargets="$(ContribMSBuildTypeLibraryBuildTypeLibraryBeforeTargets)" AfterTargets="$(ContribMSBuildTypeLibraryBuildTypeLibraryAfterTargets)" Condition="$(ContribMSBuildTypeLibraryActive)">
    <Error Text="Could not find &quot;$(ContribMSBuildTypeLibraryTlbExpPath)&quot;" Condition="!Exists($(ContribMSBuildTypeLibraryTlbExpPath))" />
    <Message Text="TlbExp:               $(ContribMSBuildTypeLibraryTlbExpPath)" />
    <Message Text="Assembly:             $(ContribMSBuildTypeLibrarySourcePath)" />
    <Message Text="Output:               $(ContribMSBuildTypeLibraryTypeLibraryTargetPath)" />
    <Exec Command="&quot;$(ContribMSBuildTypeLibraryTlbExpPath)&quot; &quot;$(ContribMSBuildTypeLibrarySourcePath)&quot; /out:&quot;$(ContribMSBuildTypeLibraryTypeLibraryTargetPath)&quot;" />
  </Target>
  <Target Name="ContribMSBuildTypeLibraryBuildAssemblyRegistration" BeforeTargets="$(ContribMSBuildTypeLibraryBuildAssemblyRegistrationBeforeTargets)" AfterTargets="$(ContribMSBuildTypeLibraryBuildAssemblyRegistrationAfterTargets)" Condition="$(ContribMSBuildTypeLibraryActive)">
    <Error Text="Could not find &quot;$(ContribMSBuildTypeLibraryRegAsmPath)&quot;" Condition="!Exists('$(ContribMSBuildTypeLibraryRegAsmPath)')" />
    <Message Text="RegAsm:               $(ContribMSBuildTypeLibraryRegAsmPath)" />
    <Message Text="Assembly:             $(ContribMSBuildTypeLibrarySourcePath)" />
    <Message Text="Output:               $(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)" />
    <Exec Command="&quot;$(ContribMSBuildTypeLibraryRegAsmPath)&quot; &quot;$(ContribMSBuildTypeLibrarySourcePath)&quot; /regfile:&quot;$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)&quot;" />
  </Target>
</Project>
