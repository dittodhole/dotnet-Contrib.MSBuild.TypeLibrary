<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ContribMSBuildTypeLibrarySourcePath>$(TargetPath)</ContribMSBuildTypeLibrarySourcePath>
    <ContribMSBuildTypeLibraryTypeLibraryTargetPath>$(TargetDir)$(TargetName).tlb</ContribMSBuildTypeLibraryTypeLibraryTargetPath>
    <ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath>$(TargetDir)$(TargetName).reg</ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath>
  </PropertyGroup>
  <ItemGroup>
    <FileWrites Include="$(ContribMSBuildTypeLibraryTypeLibraryTargetPath);$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)" />
  </ItemGroup>
  <Target Name="BuildTypeLibrary"  AfterTargets="Build">
    <PropertyGroup>
      <__ToolsPath>$(SDK40ToolsPath)</__ToolsPath>
      <__ToolsPath Condition="$(__ToolsPath) == ''">$(SDK35ToolsPath)</__ToolsPath>
      <__tlbExpPath>$(__ToolsPath)tlbexp.exe</__tlbExpPath>
    </PropertyGroup>
    <Error Text="Could not find &quot;$(__tlbExpPath)&quot;"
           Condition="!Exists('$(__tlbExpPath)')" />
    <Message Text="Using &quot;$(__tlbExpPath)&quot; to generate &quot;$(ContribMSBuildTypeLibraryTypeLibraryTargetPath)&quot;" />
    <Exec Command="&quot;$(__tlbExpPath)&quot; &quot;$(ContribMSBuildTypeLibrarySourcePath)&quot; /out:&quot;$(ContribMSBuildTypeLibraryTypeLibraryTargetPath)&quot;" />
  </Target>
  <Target Name="BuildAssemblyRegistration" AfterTargets="Build">
    <PropertyGroup>
      <__regasmPath>$(MSBuildFrameworkToolsPath)regasm.exe</__regasmPath>
    </PropertyGroup>
    <Error Text="Could not find &quot;$(__regasmPath)&quot;"
           Condition="!Exists('$(__regasmPath)')" />
    <Message Text="Using &quot;$(__regasmPath)&quot; to generate &quot;$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)&quot;" />
    <Exec Command="&quot;$(__regasmPath)&quot; &quot;$(ContribMSBuildTypeLibrarySourcePath)&quot; /regfile:&quot;$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)&quot;" />
  </Target>
  <PropertyGroup>
    <CleanDependsOn>
      $(CleanDependsOn);
      CleanTypeLibrary;
      CleanAssemblyRegistration;
    </CleanDependsOn>
  </PropertyGroup>
  <Target Name="CleanTypeLibrary">
    <Delete Files="$(ContribMSBuildTypeLibraryTypeLibraryTargetPath)" />
  </Target>
  <Target Name="CleanAssemblyRegistration">
    <Delete Files="$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)" />
  </Target>
</Project>