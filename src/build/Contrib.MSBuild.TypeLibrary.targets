<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ContribMSBuildTypeLibrarySourcePath>$(TargetPath)</ContribMSBuildTypeLibrarySourcePath>
    <ContribMSBuildTypeLibraryTypeLibraryTargetPath>$(TargetDir)$(TargetName).tlb</ContribMSBuildTypeLibraryTypeLibraryTargetPath>
    <ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath>$(TargetDir)$(TargetName).reg</ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath>
    <ContribMSBuildTypeLibraryBuildTypeLibraryBeforeTargets></ContribMSBuildTypeLibraryBuildTypeLibraryBeforeTargets>
    <ContribMSBuildTypeLibraryBuildTypeLibraryAfterTargets>Build</ContribMSBuildTypeLibraryBuildTypeLibraryAfterTargets>
    <ContribMSBuildTypeLibraryBuildAssemblyRegistrationBeforeTargets></ContribMSBuildTypeLibraryBuildAssemblyRegistrationBeforeTargets>
    <ContribMSBuildTypeLibraryBuildAssemblyRegistrationAfterTargets>Build</ContribMSBuildTypeLibraryBuildAssemblyRegistrationAfterTargets>
  </PropertyGroup>
  <Import Project="$(ProjectDir)Contrib.MSBuild.TypeLibrary.props" />
  <PropertyGroup Condition="$(ContribMSBuildTypeLibraryTlbExpPath) == ''">
    <__ToolsPath>$(SDK40ToolsPath)</__ToolsPath>
    <__ToolsPath Condition="$(__ToolsPath) == ''">$(SDK35ToolsPath)</__ToolsPath>
    <ContribMSBuildTypeLibraryTlbExpPath>$(__ToolsPath)tlbexp.exe</ContribMSBuildTypeLibraryTlbExpPath>
  </PropertyGroup>
  <PropertyGroup Condition="$(ContribMSBuildTypeLibraryRegasmPath) == ''">
    <__regasmPath>$(MSBuildFrameworkToolsPath)regasm.exe</__regasmPath>
  </PropertyGroup>
  <ItemGroup>
    <FileWrites Include="$(ContribMSBuildTypeLibraryTypeLibraryTargetPath);$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)" />
  </ItemGroup>
  <Target Name="ContribMSBuildTypeLibraryBuildTypeLibrary" BeforeTargets="$(ContribMSBuildTypeLibraryBuildTypeLibraryBeforeTargets)" AfterTargets="$(ContribMSBuildTypeLibraryBuildTypeLibraryAfterTargets)" Condition="$(ContribMSBuildTypeLibraryActive)">
    <Error Text="Could not find &quot;$(ContribMSBuildTypeLibraryTlbExpPath)&quot;" Condition="!Exists($(ContribMSBuildTypeLibraryTlbExpPath))" />
    <Message Text="TlbExp:               $(ContribMSBuildTypeLibraryTlbExpPath)" />
    <Message Text="Source:               $(ContribMSBuildTypeLibrarySourcePath)" />
    <Message Text="Type Library:         $(ContribMSBuildTypeLibraryTypeLibraryTargetPath)" />
    <Exec Command="&quot;$(ContribMSBuildTypeLibraryTlbExpPath)&quot; &quot;$(ContribMSBuildTypeLibrarySourcePath)&quot; /out:&quot;$(ContribMSBuildTypeLibraryTypeLibraryTargetPath)&quot;" />
  </Target>
  <Target Name="ContribMSBuildTypeLibraryBuildAssemblyRegistration" BeforeTargets="$(ContribMSBuildTypeLibraryBuildAssemblyRegistrationBeforeTargets)" AfterTargets="$(ContribMSBuildTypeLibraryBuildAssemblyRegistrationAfterTargets)" Condition="$(ContribMSBuildTypeLibraryActive)">
    <Error Text="Could not find &quot;$(ContribMSBuildTypeLibraryRegasmPath)&quot;" Condition="!Exists('$(ContribMSBuildTypeLibraryRegasmPath)')" />
    <Message Text="Regasm:               $(ContribMSBuildTypeLibraryRegasmPath)" />
    <Message Text="Source:               $(ContribMSBuildTypeLibrarySourcePath)" />
    <Message Text="Reg file:             $(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)" />
    <Exec Command="&quot;$(ContribMSBuildTypeLibraryRegasmPath)&quot; &quot;$(ContribMSBuildTypeLibrarySourcePath)&quot; /regfile:&quot;$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)&quot;" />
  </Target>
  <PropertyGroup>
    <CleanDependsOn>
      $(CleanDependsOn);
      CleanTypeLibrary;
      CleanAssemblyRegistration;
    </CleanDependsOn>
  </PropertyGroup>
  <Target Name="CleanTypeLibrary">
    <Delete Files="$(ContribMSBuildTypeLibraryTypeLibraryTargetPath)" />
  </Target>
  <Target Name="CleanAssemblyRegistration">
    <Delete Files="$(ContribMSBuildTypeLibraryAssemblyRegistrationTargetPath)" />
  </Target>
</Project>