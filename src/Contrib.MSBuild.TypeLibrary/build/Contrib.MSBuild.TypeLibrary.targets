<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask TaskName="TlbExp" AssemblyFile="$(ContribMSBuildTypeLibrary_Assembly)" />
  <UsingTask TaskName="RegAsm" AssemblyFile="$(ContribMSBuildTypeLibrary_Assembly)" />
  <Target Name="CreateTypeLibrary" AfterTargets="CopyFilesToOutputDirectory" Condition="'$(ContribMSBuildTypeLibrary_Active)' == 'True'">
    <ItemGroup>
      <ContribMSBuildTypeLibrary_SourceAssembly Condition="'@(ContribMSBuildTypeLibrary_SourceAssembly)' == ''" Include="$(TargetPath)" />
    </ItemGroup>
    <Message Text="MSBuildBinPath:             $(MSBuildBinPath)" />
    <Message Text="MSBuildExtensionsPath:      $(MSBuildExtensionsPath)" />
    <Message Text="MSBuildExtensionsPath32:    $(MSBuildExtensionsPath32)" />
    <Message Text="MSBuildExtensionsPath64:    $(MSBuildExtensionsPath64)" />
    <Message Text="MSBuildRuntimeType:         $(MSBuildRuntimeType)" />
    <Message Text="MSBuildStartupDirectory:    $(MSBuildStartupDirectory)" />
    <Message Text="MSBuildToolsPath:           $(MSBuildToolsPath)"/>
    <Message Text="MSBuildToolsVersion:        $(MSBuildToolsVersion)" />
    <Message Text="MSBuildVersion:             $(MSBuildVersion)" />
    <Message Text="_Assembly:                  $(ContribMSBuildTypeLibrary_Assembly)" />
    <Message Text="_SourceAssembly:            %(ContribMSBuildTypeLibrary_SourceAssembly.Identity)" />
    <Message Text="_RegAsmExe:                 $(ContribMSBuildTypeLibrary_RegAsmExe)" />
    <Message Text="_RegAsmPath:                $(ContribMSBuildTypeLibrary_RegAsmPath)" />
    <Message Text="_TlbExpExe:                 $(ContribMSBuildTypeLibrary_TlbExpExe)" />
    <Message Text="_TlbExpPath:                $(ContribMSBuildTypeLibrary_TlbExpPath)" />
    <TlbExp Assembly="@(ContribMSBuildTypeLibrary_SourceAssembly)"
            ToolExe="$(ContribMSBuildTypeLibrary_TlbExpExe)"
            ToolPath="$(ContribMSBuildTypeLibrary_TlbExpPath)">
      <Output TaskParameter="OutputFile" ItemName="FileWrites" />
    </TlbExp>
    <RegAsm Assembly="@(ContribMSBuildTypeLibrary_SourceAssembly)"
            ToolExe="$(ContribMSBuildTypeLibrary_RegAsmExe)"
            ToolPath="$(ContribMSBuildTypeLibrary_RegAsmPath)">
      <Output TaskParameter="OutputFile" ItemName="FileWrites" />
    </RegAsm>
  </Target>
</Project>
