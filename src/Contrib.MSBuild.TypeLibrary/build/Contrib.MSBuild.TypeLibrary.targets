<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask TaskName="TlbExp" AssemblyFile="$(ContribMSBuildTypeLibrary_Assembly)" />
  <UsingTask TaskName="RegAsm" AssemblyFile="$(ContribMSBuildTypeLibrary_Assembly)" />
  <Target Name="CreateTypeLibrary" AfterTargets="CopyFilesToOutputDirectory" Condition="'$(ContribMSBuildTypeLibrary_Active)' == 'True'">
    <PropertyGroup>
      <ContribMSBuildTypeLibrary_Source Condition="'$(ContribMSBuildTypeLibrary_Source)' == ''">$(TargetPath)</ContribMSBuildTypeLibrary_Source>
    </PropertyGroup>
    <Message Text="MSBuildBinPath:             $(MSBuildBinPath)" />
    <Message Text="MSBuildExtensionsPath:      $(MSBuildExtensionsPath)" />
    <Message Text="MSBuildExtensionsPath32:    $(MSBuildExtensionsPath32)" />
    <Message Text="MSBuildExtensionsPath64:    $(MSBuildExtensionsPath64)" />
    <Message Text="MSBuildRuntimeType:         $(MSBuildRuntimeType)" />
    <Message Text="MSBuildStartupDirectory:    $(MSBuildStartupDirectory)" />
    <Message Text="MSBuildToolsPath:           $(MSBuildToolsPath)"/>
    <Message Text="MSBuildToolsVersion:        $(MSBuildToolsVersion)" />
    <Message Text="MSBuildVersion:             $(MSBuildVersion)" />
    <Message Text="_Assembly:                  $(ContribMSBuildTypeLibrary_Assembly)" />
    <Message Text="_Source:                    $(ContribMSBuildTypeLibrary_Source)" />
    <Message Text="_RegAsmExe:                 $(ContribMSBuildTypeLibrary_RegAsmExe)" />
    <Message Text="_RegAsmPath:                $(ContribMSBuildTypeLibrary_RegAsmPath)" />
    <Message Text="_TlbExpExe:                 $(ContribMSBuildTypeLibrary_TlbExpExe)" />
    <Message Text="_TlbExpPath:                $(ContribMSBuildTypeLibrary_TlbExpPath)" />
    <TlbExp Target="$(ContribMSBuildTypeLibrary_Source)"
            ToolExe="$(ContribMSBuildTypeLibrary_TlbExpExe)"
            ToolPath="$(ContribMSBuildTypeLibrary_TlbExpPath)" />
    <RegAsm Target="$(ContribMSBuildTypeLibrary_Source)"
            ToolExe="$(ContribMSBuildTypeLibrary_RegAsmExe)"
            ToolPath="$(ContribMSBuildTypeLibrary_RegAsmPath)" />
  </Target>
</Project>
